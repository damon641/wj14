{% extends "partition/layout.html" %}
<style>
    .box {
        box-shadow: none !important;
    }
</style>
{% block body %}

<!-- Main Content -->
<div class="page-wrapper">
    <div class="container-fluid">
        <!-- Title -->
        <section class="content-header">
            <h1>Pending Request</h1>
            <ol class="breadcrumb">
                <li>
                    <a href="#"> <i class="fa fa-dashboard"></i> Dashboard</a>
                </li>
                <li class="active" href="/accountNumberUpdateRequest">Request</li>
            </ol>
        </section>
        <!-- /Title -->

        <!-- Row -->
        <section class="content">
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default card-view">
                        <div class="panel-heading">
                            <div class="pull-left">
                                <h6 class="panel-title txt-dark">Pending Request</h6>

                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="panel-wrapper collapse in">
                            <div class="panel-body">
                                <div class="table-wrap">
                                    <div class="table-responsive">
                                        <table id="myTable" class="table table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>UID</th>
                                                    <th>Username</th>
                                                    <th>Current A/C No</th>
                                                    <th>Title</th>
                                                    <th>Description</th>
                                                    <th>new A/C No</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                            <tfoot>
                                                <tr>
                                                    <th>UID</th>
                                                    <th>Username</th>
                                                    <th>Current A/C No</th>
                                                    <th>Title</th>
                                                    <th>Description</th>
                                                    <th>new A/C No</th>
                                                    <th>Action</th>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </section>
</div>
</div>
<section class="content">
    <!-- Row -->
    <div class="row">
        <!-- /.modal -->
        <div id="responsive-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
              Ã—
            </button>
                        <h5 class="modal-title">Player Information</h5>
                    </div>
                    <div class="modal-body" id="contentBody">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="box-body box-profile">
                                    <img class="profile-user-img img-responsive img-circle" src="/profile/user.png" alt="User profile picture" />

                                    <h3 class="profile-username text-center" id="show-email"></h3>
                                    <button type="button" class="btn btn-block btn-success .btn-lg">
                    Chips: <span id="show-chips"></span>
                  </button>
                                </div>
                                <!-- /.box-body -->
                            </div>
                            <div class="col-md-6">
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <span>{{ player.device_Id }}</span>
                                        <h3 class="box-title">Player Details</h3>
                                    </div>
                                    <div class="box-body box-profile">
                                        <ul class="list-group list-group-unbordered">
                                            <li class="list-group-item">
                                                <b>First Name</b>
                                                <a class="pull-right" id="show-firstname"></a>
                                            </li>
                                            <li class="list-group-item">
                                                <b>Last Name</b>
                                                <a class="pull-right" id="show-lastname"></a>
                                            </li>
                                            <li class="list-group-item">
                                                <b>Gender</b>
                                                <a class="pull-right" id="show-gender"></a>
                                            </li>
                                            <li class="list-group-item">
                                                <b>Mobile</b>
                                                <a class="pull-right" id="show-mobile"></a>
                                            </li>
                                            <li class="list-group-item">
                                                <b>Registered Date</b>
                                                <a class="pull-right" id="show-reDate"></a>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- /.box-body -->
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Player Bank Details</h3>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <strong>
                      <i class="fa fa-university" aria-hidden="true"></i> Bank
                      Name</strong>
                                        <p class="text-muted" id="show-bank_name"></p>

                                        <hr />

                                        <strong>
                      <i class="fa fa-circle-o margin-r-5"></i> Account
                      Number</strong>

                                        <p class="text-muted" id="show-accountNumber"></p>

                                        <hr />

                                        <strong>
                      <i class="fa fa-circle-o margin-r-5"></i> Account
                      Type</strong>

                                        <p class="text-muted" id="show-accountType"></p>

                                        <hr />

                                        <strong>
                      <i class="fa fa-circle-o margin-r-5"></i> CPF</strong>

                                        <p class="text-muted" id="show-CPF"></p>

                                        <hr />

                                        <strong>
                      <i class="fa fa-circle-o margin-r-5"></i>Account Agency
                      Number</strong>

                                        <p class="text-muted" id="show-agency"></p>

                                        <hr />
                                    </div>
                                    <!-- /.box-body -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Button trigger modal -->
    </div>
    <!-- /Row -->
</section>

{% endblock %} {% block Jscript %}
<!-- <script src="https://code.jquery.com/jquery-3.3.1.js"></script> -->
<!-- <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script> -->
<script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js"></script>
<!-- <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.flash.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js"></script>
<script>
    $(document).ready(function() {
        var host = window.location.origin;
        $('#myTable').DataTable({
            dom: 'Blfrtip',
            buttons: ['copy', 'csv', 'excel', 'pdf', 'print'],
            oLanguage: {
                sSearch: 'Search Username',
            },
            // "scrollX": true,
            processing: true,
            serverSide: true,
            // "searching": false,
            ordering: false,
            autoWidth: false,
            pageLength: 10,
            ajax: host + '/getAccountNumberUpdateRequest',
            columns: [{
                data: 'playerId.uniqId',
            }, {
                data: 'playerId.username',
            }, {
                data: 'playerId.accountNumber',
                render: function(data, type, row) {
                    if (row.playerId) {
                        if (row.playerId.accountNumber == '' || row.playerId.accountNumber == undefined) {
                            return '---';
                        } else {
                            return row.playerId.accountNumber;
                        }
                    } else {
                        return '---';
                    }
                },
            }, {
                data: 'title',
            }, {
                data: 'description',
            }, {
                data: 'accountNumber',
            }, {
                data: 'action',
                render: function(data, type, row) {
                    if (row.action == false) {
                        return (
                            '<button type="button" title="Approve" name="delete" id="' +
                            row._id +
                            '" class="btn btn-primary btn-xs btn-rounded response">Approve</button> <button type="button" title="Denied" name="delete" id="' +
                            row._id +
                            '" class="btn btn-danger btn-xs btn-rounded deniedresponse">Denied</button>'
                        );
                    } else {
                        return 'Done';
                    }
                    //return '<button type="button" title="Done Payment" name="delete" id="' + row._id + '" class="btn btn-primary btn-xs btn-rounded response">Approve</button> <button type="button" title="Done Payment" name="delete" id="' + row._id + '" class="btn btn-danger btn-xs btn-rounded deniedresponse">Denied</button> <button type="button" title="Done Payment" name="delete" id="' + row._id + '" class="btn btn-primary btn-xs btn-rounded accountinfo">Account info</button>';
                },
            }, ],
        });

        $(function() {
            'use strict';

            var SweetAlert = function() {};

            (SweetAlert.prototype.init = function() {
                $('body').on('click', '.accountinfo', function(e) {
                    var id = $(this).attr('id');
                    var response = $(this).attr('accountinfo');
                    var thisElement = this;
                    $.ajax({
                        type: 'post',
                        url: host + '/player/account_info/',
                        data: {
                            id: id
                        },
                        success: function(response) {
                            if (response.status == 'success') {
                                for (let key in response.result) {
                                    if ($('#show-' + key).length) {
                                        $('#show-' + key).html(response.result[key]);
                                    }
                                }
                                $('#responsive-modal').modal('show');
                            }
                        },
                        error: function(resultData) {
                            alert('fail');
                        },
                    });
                });

                //Parameter
                $('body').on('click', '.response', function(e) {
                    var id = $(this).attr('id');
                    console.log('id: ', id);
                    var response = $(this).attr('response');
                    var thisElement = this;
                    swal({
                            title: 'Are you sure?',
                            text: 'You will not be able to Revert this Action!',
                            type: 'warning',
                            showCancelButton: true,
                            confirmButtonColor: '#e69a2a',
                            confirmButtonText: 'Yes,do it!',
                            cancelButtonText: 'No, cancel it!',
                            closeOnConfirm: false,
                            closeOnCancel: false,
                        },
                        function(isConfirm) {
                            if (isConfirm) {
                                $.ajax({
                                    type: 'POST',
                                    url: host + '/accountNumber-request-update',
                                    data: {
                                        id: id,
                                        flag: 1,
                                    },
                                    success: function(resultData) {
                                        console.log(resultData.success);
                                        if (resultData.success == 'success') {
                                            /*$(thisElement)
																										.parent()
																										.parent()
																										.hide(700); */
                                            swal('!', resultData.message, 'success');
                                            window.location.reload();
                                        } else if (resultData.fail == 'fail') {
                                            swal('!', resultData.message, 'error');
                                        }
                                    },
                                });
                            } else {
                                swal('Cancelled', 'Something went wrong', 'error');
                            }
                        }
                    );
                    return false;
                });

                $('body').on('click', '.deniedresponse', function(e) {
                    var id = $(this).attr('id');
                    console.log('id: ', id);
                    var response = $(this).attr('deniedresponse');
                    var thisElement = this;
                    swal({
                            title: 'Are you sure?',
                            text: 'You will not be able to Revert this Action!',
                            type: 'warning',
                            showCancelButton: true,
                            confirmButtonColor: '#e69a2a',
                            confirmButtonText: 'Yes,do it!',
                            cancelButtonText: 'No, cancel it!',
                            closeOnConfirm: false,
                            closeOnCancel: false,
                        },
                        function(isConfirm) {
                            if (isConfirm) {
                                $.ajax({
                                    type: 'POST',
                                    url: host + '/accountNumber-request-update',
                                    data: {
                                        id: id,
                                        flag: 2,
                                    },
                                    success: function(resultData) {
                                        console.log(resultData);
                                        if (resultData.success == 'success') {
                                            /*$(thisElement)
																										.parent()
																										.parent()
																										.hide(700); */
                                            swal('!', resultData.message, 'success');
                                            window.location.reload();
                                        } else {
                                            swal('Alert', 'Something went wrong.', 'error');
                                        }
                                    },
                                });
                            } else {
                                swal('Cancelled', 'Something went wrong', 'error');
                            }
                        }
                    );
                    return false;
                });
                // Active & Deactive

                // $('body').on('click', '.playerActive', function(e){
                // 		var id = $(this).attr('id');
                // 		var thisElement = this;
                // 			swal({
                // 					title: "Are you sure?",
                // 					text: "Do you want to update the status?",
                // 					type: "warning",
                // 					showCancelButton: true,
                // 					confirmButtonColor: "#e69a2a",
                // 					confirmButtonText: "Yes, Update it!",
                // 					cancelButtonText: "No, cancel pls!",
                // 					closeOnConfirm: false,
                // 					closeOnCancel: false
                // 			}, function(isConfirm){
                // 					if (isConfirm) {
                // 						$.ajax({
                // 							type: 'POST',
                // 							url: host + "/player/active",
                // 							data: {id: id},
                // 							success: function(resultData , data) {
                // 								console.log(data);
                // 								if (resultData == 'success') {
                // 									location.reload();
                // 								 $(thisElement).parent().parent().hide(700);
                // 								 swal("Update!", "Player Status Updated Successfully..", "success");
                // 								}else {
                // 										alert("Something went wrong")
                // 								}
                //
                // 							}
                // 						});
                // 							swal("Success!", "Player Status Updated Succesfully.", "success");
                // 					} else {
                // 							swal("Cancelled", "Player Status not Updated)", "error");
                // 					}
                // 			});
                // 			return false;
                // });
            }),
            ($.SweetAlert = new SweetAlert()),
            ($.SweetAlert.Constructor = SweetAlert);

            $.SweetAlert.init();
        });

        // $("body").on("click", ".addChips", function(){
        // 	var PlayerId = $(this).attr("id");
        //   console.log("player id ----------->",PlayerId)
        // 	var html = '<input type="hidden" name="playerId" value="'+PlayerId+'" />';
        // 	$("#chipsAdd").html(html);
        // });
    });
</script>
{% endblock %}